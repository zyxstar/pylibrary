# -*- encoding:utf-8 -*-
from mako import runtime, filters, cache
UNDEFINED = runtime.UNDEFINED
__M_dict_builtin = dict
__M_locals_builtin = locals
_magic_number = 6
_modified_time = 1333946545.6400001
_template_filename=u'F:/eclipsWorkSpace/pylibrary/tmpl/borrow/renew_1.html'
_template_uri=u'renew_1.html'
_template_cache=cache.Cache(__name__, _modified_time)
_source_encoding='utf-8'
_exports = []


def render_body(context,**pageargs):
    context.caller_stack._push_frame()
    try:
        __M_locals = __M_dict_builtin(pageargs=pageargs)
        __M_writer = context.writer()
        # SOURCE LINE 1
        __M_writer(u'<div class="table-wrapper">\r\n    <table id="borrnow_table" width="100%">\r\n        <thead>\r\n            <tr>\r\n                <th class="table-header light">\r\n                    bookinsid\r\n                </th>\r\n                <th class="table-header light">\r\n                    bookclsid\r\n                </th>\r\n                <th class="table-header light">\r\n                    bookname\r\n                </th>\r\n                <th class="table-header light">\r\n                    auth\r\n                </th>\r\n                <th class="table-header light">\r\n                    isbn\r\n                </th>\r\n                <th class="table-header light">\r\n                    pub\r\n                </th>\r\n                <th class="table-header light">\r\n                    borrdt\r\n                </th>\r\n                <th class="table-header light">\r\n                    borrexpdt\r\n                </th>\r\n                <th class="table-header light">\r\n                    times\r\n                </th>\r\n                <th class="table-header light">\r\n                    \u9009\u62e9\r\n                </th>\r\n            </tr>\r\n        </thead>\r\n        <tbody>\r\n        </tbody>\r\n    </table>\r\n    <div class="summary">\r\n        <strong>\r\n            <label style="color: #65A32E;" id="sum_count">\r\n            </label>\r\n        </strong>\r\n        <label for="chk_all">\r\n            \u5168\u90e8</label>\r\n        <input type="checkbox" id="chk_all" name="chk_all" />\r\n        <input type="button" id="btn_renew" class="btn" value="\u7eed\u501f" />\r\n    </div>\r\n</div>\r\n<script language="javascript" type="text/javascript">\r\n    $(document).ready(function () {\r\n        var count = 0;\r\n\r\n        $("#chk_all").click(function () {\r\n            var me = this;\r\n            $(\'#borrnow_table :checkbox\').each(function (index, chk) {\r\n                chk.checked = me.checked;\r\n                var $tr = $(\'#tr_\' + chk.value);\r\n                if (me.checked) {\r\n                    $tr.addClass("selected");\r\n                }\r\n                else {\r\n                    $tr.removeClass("selected");\r\n                }\r\n            });\r\n        });\r\n\r\n        $("#btn_renew").click(function () {\r\n            $(\'#borrnow_table :checkbox\').each(function (index, chk) {\r\n                if (chk.checked) {\r\n                    var formData = { act: \'renew\', bookinsid: chk.value, bookclsid: $(chk).data("borrnow").bookclsid, bookname: $(chk).data("borrnow").bookname };\r\n                    complib.xhr("/borrow/renew", \'POST\', formData, function (ret) {\r\n                        $("td#borrexpdt_" + chk.value).html("<strong style=\'color:#65A32E\'>" + complib.dateFormat(ret.newexpdt) + "</strong>");\r\n                        $("td#renewtimes_" + chk.value).html("<strong style=\'color:#65A32E\'>" + complib.stringFormat(ret.renewtimes) + "</strong>");\r\n                        $(\'#tr_\' + chk.value).removeClass("selected");\r\n                        //$(chk).remove();\r\n                        complib.chgTdStatus($(chk).parent("td")[0], "ok");\r\n                        count++;\r\n                        $("#sum_count").html("\u6210\u529f\u7eed\u501f" + count + "\u672c");\r\n                    });\r\n                }\r\n            });\r\n        });\r\n\r\n        function addRow(reader, borrnow) {\r\n            var tr = document.createElement("tr");\r\n            tr.id = "tr_" + borrnow.bookinsid;\r\n            tr.className = "table-row";\r\n\r\n            bindTr(tr, borrnow);\r\n\r\n            if (borrnow.notborrexp_c && borrnow.renewtimes_c) {\r\n                build_chk(tr, borrnow);\r\n            }\r\n            else {\r\n                var td = document.createElement("td");\r\n                complib.chgTdStatus(td, "fail");\r\n                tr.appendChild(td);\r\n            }\r\n            $("#borrnow_table tbody").append(tr);\r\n        }\r\n\r\n        function bindTr(tr, borrnow) {\r\n            var f = complib.floatFormat;\r\n            var s = complib.stringFormat;\r\n            var b = complib.boolFormat;\r\n            var d = complib.dateFormat;\r\n            var m = complib.moneyFormat;\r\n            var v_borrexpdt = function (obj) { return obj.notborrexp_c; };\r\n            var v_renewtimes = function (obj) { return obj.renewtimes_c; };\r\n\r\n            var descs = [\r\n                { bookinsid: [s, null, null] }, { bookclsid: [s, null, null] }, { bookname: [s, null, null] },\r\n                { auth: [s, null, null] }, { isbn: [s, null, null] }, { pubcd_r: [s, null, null] },\r\n                { borrdt: [d, null, null] }, { borrexpdt: [d, null, v_borrexpdt] }, { renewtimes: [s, "right", v_renewtimes] }\r\n            ];\r\n            complib.appendTdArr(tr, borrnow, "bookinsid", descs);\r\n        }\r\n\r\n        function build_chk(tr, borrnow) {\r\n            var td_renew = document.createElement("td");\r\n            $(td_renew).addClass("center");\r\n            var chk = document.createElement("input");\r\n            chk.type = "checkbox";\r\n            chk.id = "chk_" + borrnow.bookinsid;\r\n            chk.name = "chk_" + borrnow.bookinsid;\r\n            chk.value = borrnow.bookinsid;\r\n            $(chk).data("borrnow", borrnow);\r\n            $(chk).click(function () {\r\n                if (this.checked) {\r\n                    $(tr).addClass("selected");\r\n                }\r\n                else {\r\n                    $(tr).removeClass("selected");\r\n                    var chk_all = $("#chk_all")[0];\r\n                    if (chk_all.checked) {\r\n                        chk_all.checked = false;\r\n                    }\r\n                }\r\n            });\r\n\r\n            td_renew.appendChild(chk);\r\n            tr.appendChild(td_renew);\r\n        }\r\n\r\n        window.addRow = addRow;\r\n    });\r\n</script>\r\n')
        return ''
    finally:
        context.caller_stack._pop_frame()


